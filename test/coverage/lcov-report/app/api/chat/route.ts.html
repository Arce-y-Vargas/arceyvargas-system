
<!doctype html>
<html lang="en">

<head>
    <title>Code coverage report for app/api/chat/route.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../prettify.css" />
    <link rel="stylesheet" href="../../../base.css" />
    <link rel="shortcut icon" type="image/x-icon" href="../../../favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
    
<body>
<div class='wrapper'>
    <div class='pad1'>
        <h1><a href="../../../index.html">All files</a> / <a href="index.html">app/api/chat</a> route.ts</h1>
        <div class='clearfix'>
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Statements</span>
                <span class='fraction'>0/26</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Branches</span>
                <span class='fraction'>0/10</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Functions</span>
                <span class='fraction'>0/3</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Lines</span>
                <span class='fraction'>0/25</span>
            </div>
        
            
        </div>
        <p class="quiet">
            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
        </p>
        <template id="filterTemplate">
            <div class="quiet">
                Filter:
                <input type="search" id="fileSearch">
            </div>
        </template>
    </div>
    <div class='status-line low'></div>
    <pre><table class="coverage">
<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
<a name='L2'></a><a href='#L2'>2</a>
<a name='L3'></a><a href='#L3'>3</a>
<a name='L4'></a><a href='#L4'>4</a>
<a name='L5'></a><a href='#L5'>5</a>
<a name='L6'></a><a href='#L6'>6</a>
<a name='L7'></a><a href='#L7'>7</a>
<a name='L8'></a><a href='#L8'>8</a>
<a name='L9'></a><a href='#L9'>9</a>
<a name='L10'></a><a href='#L10'>10</a>
<a name='L11'></a><a href='#L11'>11</a>
<a name='L12'></a><a href='#L12'>12</a>
<a name='L13'></a><a href='#L13'>13</a>
<a name='L14'></a><a href='#L14'>14</a>
<a name='L15'></a><a href='#L15'>15</a>
<a name='L16'></a><a href='#L16'>16</a>
<a name='L17'></a><a href='#L17'>17</a>
<a name='L18'></a><a href='#L18'>18</a>
<a name='L19'></a><a href='#L19'>19</a>
<a name='L20'></a><a href='#L20'>20</a>
<a name='L21'></a><a href='#L21'>21</a>
<a name='L22'></a><a href='#L22'>22</a>
<a name='L23'></a><a href='#L23'>23</a>
<a name='L24'></a><a href='#L24'>24</a>
<a name='L25'></a><a href='#L25'>25</a>
<a name='L26'></a><a href='#L26'>26</a>
<a name='L27'></a><a href='#L27'>27</a>
<a name='L28'></a><a href='#L28'>28</a>
<a name='L29'></a><a href='#L29'>29</a>
<a name='L30'></a><a href='#L30'>30</a>
<a name='L31'></a><a href='#L31'>31</a>
<a name='L32'></a><a href='#L32'>32</a>
<a name='L33'></a><a href='#L33'>33</a>
<a name='L34'></a><a href='#L34'>34</a>
<a name='L35'></a><a href='#L35'>35</a>
<a name='L36'></a><a href='#L36'>36</a>
<a name='L37'></a><a href='#L37'>37</a>
<a name='L38'></a><a href='#L38'>38</a>
<a name='L39'></a><a href='#L39'>39</a>
<a name='L40'></a><a href='#L40'>40</a>
<a name='L41'></a><a href='#L41'>41</a>
<a name='L42'></a><a href='#L42'>42</a>
<a name='L43'></a><a href='#L43'>43</a>
<a name='L44'></a><a href='#L44'>44</a>
<a name='L45'></a><a href='#L45'>45</a>
<a name='L46'></a><a href='#L46'>46</a>
<a name='L47'></a><a href='#L47'>47</a>
<a name='L48'></a><a href='#L48'>48</a>
<a name='L49'></a><a href='#L49'>49</a>
<a name='L50'></a><a href='#L50'>50</a>
<a name='L51'></a><a href='#L51'>51</a>
<a name='L52'></a><a href='#L52'>52</a>
<a name='L53'></a><a href='#L53'>53</a>
<a name='L54'></a><a href='#L54'>54</a>
<a name='L55'></a><a href='#L55'>55</a>
<a name='L56'></a><a href='#L56'>56</a>
<a name='L57'></a><a href='#L57'>57</a>
<a name='L58'></a><a href='#L58'>58</a>
<a name='L59'></a><a href='#L59'>59</a>
<a name='L60'></a><a href='#L60'>60</a>
<a name='L61'></a><a href='#L61'>61</a>
<a name='L62'></a><a href='#L62'>62</a>
<a name='L63'></a><a href='#L63'>63</a>
<a name='L64'></a><a href='#L64'>64</a>
<a name='L65'></a><a href='#L65'>65</a>
<a name='L66'></a><a href='#L66'>66</a>
<a name='L67'></a><a href='#L67'>67</a>
<a name='L68'></a><a href='#L68'>68</a>
<a name='L69'></a><a href='#L69'>69</a>
<a name='L70'></a><a href='#L70'>70</a>
<a name='L71'></a><a href='#L71'>71</a>
<a name='L72'></a><a href='#L72'>72</a>
<a name='L73'></a><a href='#L73'>73</a>
<a name='L74'></a><a href='#L74'>74</a>
<a name='L75'></a><a href='#L75'>75</a>
<a name='L76'></a><a href='#L76'>76</a>
<a name='L77'></a><a href='#L77'>77</a>
<a name='L78'></a><a href='#L78'>78</a>
<a name='L79'></a><a href='#L79'>79</a>
<a name='L80'></a><a href='#L80'>80</a>
<a name='L81'></a><a href='#L81'>81</a>
<a name='L82'></a><a href='#L82'>82</a>
<a name='L83'></a><a href='#L83'>83</a>
<a name='L84'></a><a href='#L84'>84</a>
<a name='L85'></a><a href='#L85'>85</a>
<a name='L86'></a><a href='#L86'>86</a>
<a name='L87'></a><a href='#L87'>87</a>
<a name='L88'></a><a href='#L88'>88</a>
<a name='L89'></a><a href='#L89'>89</a>
<a name='L90'></a><a href='#L90'>90</a>
<a name='L91'></a><a href='#L91'>91</a>
<a name='L92'></a><a href='#L92'>92</a>
<a name='L93'></a><a href='#L93'>93</a>
<a name='L94'></a><a href='#L94'>94</a>
<a name='L95'></a><a href='#L95'>95</a>
<a name='L96'></a><a href='#L96'>96</a>
<a name='L97'></a><a href='#L97'>97</a>
<a name='L98'></a><a href='#L98'>98</a>
<a name='L99'></a><a href='#L99'>99</a>
<a name='L100'></a><a href='#L100'>100</a>
<a name='L101'></a><a href='#L101'>101</a>
<a name='L102'></a><a href='#L102'>102</a>
<a name='L103'></a><a href='#L103'>103</a>
<a name='L104'></a><a href='#L104'>104</a>
<a name='L105'></a><a href='#L105'>105</a>
<a name='L106'></a><a href='#L106'>106</a>
<a name='L107'></a><a href='#L107'>107</a>
<a name='L108'></a><a href='#L108'>108</a>
<a name='L109'></a><a href='#L109'>109</a>
<a name='L110'></a><a href='#L110'>110</a>
<a name='L111'></a><a href='#L111'>111</a>
<a name='L112'></a><a href='#L112'>112</a>
<a name='L113'></a><a href='#L113'>113</a>
<a name='L114'></a><a href='#L114'>114</a>
<a name='L115'></a><a href='#L115'>115</a>
<a name='L116'></a><a href='#L116'>116</a>
<a name='L117'></a><a href='#L117'>117</a>
<a name='L118'></a><a href='#L118'>118</a>
<a name='L119'></a><a href='#L119'>119</a>
<a name='L120'></a><a href='#L120'>120</a>
<a name='L121'></a><a href='#L121'>121</a>
<a name='L122'></a><a href='#L122'>122</a>
<a name='L123'></a><a href='#L123'>123</a>
<a name='L124'></a><a href='#L124'>124</a>
<a name='L125'></a><a href='#L125'>125</a>
<a name='L126'></a><a href='#L126'>126</a>
<a name='L127'></a><a href='#L127'>127</a>
<a name='L128'></a><a href='#L128'>128</a>
<a name='L129'></a><a href='#L129'>129</a>
<a name='L130'></a><a href='#L130'>130</a>
<a name='L131'></a><a href='#L131'>131</a>
<a name='L132'></a><a href='#L132'>132</a>
<a name='L133'></a><a href='#L133'>133</a>
<a name='L134'></a><a href='#L134'>134</a>
<a name='L135'></a><a href='#L135'>135</a>
<a name='L136'></a><a href='#L136'>136</a>
<a name='L137'></a><a href='#L137'>137</a>
<a name='L138'></a><a href='#L138'>138</a>
<a name='L139'></a><a href='#L139'>139</a>
<a name='L140'></a><a href='#L140'>140</a>
<a name='L141'></a><a href='#L141'>141</a>
<a name='L142'></a><a href='#L142'>142</a>
<a name='L143'></a><a href='#L143'>143</a>
<a name='L144'></a><a href='#L144'>144</a>
<a name='L145'></a><a href='#L145'>145</a>
<a name='L146'></a><a href='#L146'>146</a>
<a name='L147'></a><a href='#L147'>147</a>
<a name='L148'></a><a href='#L148'>148</a>
<a name='L149'></a><a href='#L149'>149</a>
<a name='L150'></a><a href='#L150'>150</a>
<a name='L151'></a><a href='#L151'>151</a>
<a name='L152'></a><a href='#L152'>152</a>
<a name='L153'></a><a href='#L153'>153</a>
<a name='L154'></a><a href='#L154'>154</a>
<a name='L155'></a><a href='#L155'>155</a>
<a name='L156'></a><a href='#L156'>156</a>
<a name='L157'></a><a href='#L157'>157</a>
<a name='L158'></a><a href='#L158'>158</a>
<a name='L159'></a><a href='#L159'>159</a>
<a name='L160'></a><a href='#L160'>160</a></td><td class="line-coverage quiet"><span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import { NextRequest, NextResponse } from <span class="cstat-no" title="statement not covered" >'next/server';</span>
&nbsp;
// Base de conocimiento del chatbot con preguntas y respuestas predefinidas
const KNOWLEDGE_BASE = <span class="cstat-no" title="statement not covered" >{</span>
  // Preguntas sobre empleados
  'como agregar empleado': 'Para agregar un empleado:\n1. Ve a Dashboard → Empleados (/dashboard/employees)\n2. Haz clic en "Agregar Empleado"\n3. Completa los datos: cedula, nombre, posicion, departamento, salario\n4. Haz clic en "Guardar"\n\nEl sistema validara que la cedula no este duplicada.',
  
  'como editar empleado': 'Para editar un empleado:\n1. Ve a Dashboard → Empleados\n2. Busca al empleado en la tabla\n3. Haz clic en el icono de editar (lapiz)\n4. Modifica los datos necesarios\n5. Guarda los cambios',
  
  'que es nomina': 'El modulo de Nomina permite:\n• Calcular salarios automaticamente\n• Gestionar deducciones y bonificaciones\n• Generar recibos de pago\n• Consultar historial de pagos\n\nAccede desde Dashboard → Nomina (/dashboard/payroll)',
&nbsp;
  // Preguntas sobre vacaciones
  'como solicitar vacaciones': 'Para solicitar vacaciones:\n1. Ve a Dashboard → Vacaciones (/dashboard/vacations)\n2. Completa el formulario con fechas de inicio y fin\n3. Agrega la razon de la solicitud\n4. Envía la solicitud\n\nLos administradores podran aprobar o rechazar tu solicitud.',
  
  'como aprobar vacaciones': 'Para aprobar vacaciones (solo administradores):\n1. Ve a Dashboard → Empleados → Vacaciones\n2. Revisa las solicitudes pendientes\n3. Haz clic en "Aprobar" o "Rechazar"\n4. El empleado sera notificado del resultado',
&nbsp;
  // Preguntas sobre inventario
  'como agregar producto inventario': 'Para agregar productos al inventario:\n1. Ve a Dashboard → Inventario (/dashboard/inventory)\n2. Haz clic en "Agregar Item"\n3. Completa: nombre, categoria, cantidad, precio\n4. Guarda el item\n\nEl sistema controlara el stock automaticamente.',
  
  'como controlar stock': 'El control de stock incluye:\n• Alertas cuando hay poco inventario\n• Registro de movimientos (entradas/salidas)\n• Reportes de existencias\n• Categorizacion de productos\n\nTodo se maneja desde el modulo de Inventario.',
&nbsp;
  // Preguntas sobre proyectos
  'como crear proyecto': 'Para crear un proyecto:\n1. Ve a Dashboard → Proyectos (/dashboard/proyectos)\n2. Haz clic en "Agregar Proyecto"\n3. Completa: nombre, cliente, fechas, descripcion\n4. Selecciona el estado inicial\n5. Guarda el proyecto\n\nEl sistema validara que la fecha de fin no sea anterior al inicio.',
  
  'estados de proyecto': 'Los proyectos pueden tener estos estados:\n• ACTIVO: Proyecto en desarrollo\n• COMPLETADO: Proyecto terminado\n• CANCELADO: Proyecto cancelado\n\nPuedes cambiar el estado editando el proyecto.',
&nbsp;
  // Preguntas sobre cotizaciones
  'como crear cotizacion': 'Para crear una cotizacion:\n1. Ve a Dashboard → Cotizaciones (/dashboard/quotes)\n2. Haz clic en "Agregar Cotizacion"\n3. Completa: cliente, fecha, total, items\n4. Selecciona el estado\n5. Guarda la cotizacion',
  
  'estados cotizacion': 'Estados de cotizaciones:\n• PENDIENTE: Esperando respuesta del cliente\n• APROBADA: Cliente acepto la cotizacion\n• RECHAZADA: Cliente rechazo la cotizacion\n• EN PROCESO: Cotizacion en desarrollo\n• COMPLETADA: Cotizacion finalizada',
&nbsp;
  // Preguntas sobre facturas
  'como crear factura': 'Para crear una factura:\n1. Ve a Dashboard → Facturas (/dashboard/accounting)\n2. Haz clic en "Agregar Factura"\n3. Completa: numero, proyecto, categoria, monto\n4. Establece fecha de emision\n5. Guarda la factura\n\nEl saldo inicial sera igual al monto.',
  
  'como marcar factura pagada': 'Para marcar una factura como pagada:\n1. Ve a la lista de facturas\n2. Edita la factura\n3. Establece la fecha de pago\n4. Ajusta el saldo a 0\n5. Guarda los cambios',
&nbsp;
  // Preguntas sobre reportes
  'como generar reportes': 'Para generar reportes:\n1. Ve a Dashboard → Reportes (/dashboard/reports)\n2. Selecciona la pestaña del reporte deseado:\n   - General: Resumen de todas las metricas\n   - Empleados: Datos de personal\n   - Inventario: Stock y productos\n   - Facturacion: Montos y pagos\n   - Finanzas: Ingresos y egresos\n3. Haz clic en "Exportar PDF"',
  
  'que reportes hay': 'Tipos de reportes disponibles:\n• GENERAL: Resumen completo del sistema\n• EMPLEADOS: Datos de personal y vacaciones\n• INVENTARIO: Stock y movimientos\n• FACTURACION: Montos facturados y cobrados\n• FINANZAS: Ingresos, egresos y balance\n\nTodos se pueden exportar a PDF.',
&nbsp;
  // Preguntas sobre navegacion
  'como navegar sistema': 'Navegacion del sistema:\n• /dashboard - Panel principal con metricas\n• /dashboard/employees - Gestion de empleados\n• /dashboard/payroll - Nomina y planillas\n• /dashboard/vacations - Solicitudes de vacaciones\n• /dashboard/inventory - Control de inventario\n• /dashboard/proyectos - Gestion de proyectos\n• /dashboard/quotes - Cotizaciones\n• /dashboard/accounting - Facturas\n• /dashboard/reports - Reportes y analytics',
  
  'donde esta dashboard': 'El dashboard principal esta en la ruta /dashboard\n\nAqui encontraras:\n• Metricas clave de la empresa\n• Resumen de empleados, vacaciones, inventario\n• Balance financiero actual\n• Accesos rapidos a los modulos\n• Asistente de chat',
&nbsp;
  // Preguntas generales
  'que es arce vargas': 'Arce &amp; Vargas es un sistema integral de gestion empresarial que incluye:\n• Gestion de empleados y nomina\n• Control de vacaciones y horas extra\n• Inventario y productos\n• Proyectos y cotizaciones\n• Facturacion y finanzas\n• Reportes y analytics\n\nDesarrollado con Next.js, Firebase y TypeScript.',
  
  'como funciona sistema': 'El sistema funciona con:\n• AUTENTICACION: Login seguro con Firebase\n• MODULOS: Diferentes secciones para cada area\n• DATOS: Almacenados en Firestore (NoSQL)\n• REPORTES: Exportacion a PDF y Excel\n• RESPONSIVE: Funciona en desktop y movil\n• TEMAS: Modo claro y oscuro',
  
  'ayuda general': 'AYUDA GENERAL:\n• Usa el menu lateral para navegar\n• Cada modulo tiene botones de "Agregar" y "Editar"\n• Los reportes se exportan desde la seccion Reportes\n• Usa los filtros para encontrar informacion\n• El dashboard muestra un resumen general\n• Este chat te ayuda con preguntas especificas',
&nbsp;
  // Preguntas adicionales
  'como buscar': 'Para buscar en cualquier modulo:\n• Usa la barra de busqueda en la parte superior de cada tabla\n• Los filtros te permiten encontrar por categoria, estado, etc.\n• Usa las opciones de ordenamiento haciendo clic en los encabezados\n• Muchos modulos tienen filtros avanzados disponibles',
  
  'como exportar datos': 'Para exportar datos:\n• REPORTES: Ve a /dashboard/reports y selecciona "Exportar PDF"\n• TABLAS: Muchas tablas tienen boton de exportacion\n• FORMATO: Los datos se exportan en PDF o Excel\n• CONTENIDO: Se exporta solo lo que este filtrado/visible',
  
  'problema login': 'Si tienes problemas para iniciar sesion:\n• Verifica tu email y contraseña\n• Asegurate de estar registrado en el sistema\n• Si olvidaste tu contraseña, usa "Recuperar contraseña"\n• Contacta al administrador si persisten los problemas',
  
  'que modulos hay': 'MODULOS DISPONIBLES:\n• EMPLEADOS: Gestion de personal\n• NOMINA: Planillas y pagos\n• VACACIONES: Solicitudes y aprobaciones\n• INVENTARIO: Control de stock\n• PROYECTOS: Gestion de trabajos\n• COTIZACIONES: Presupuestos a clientes\n• FACTURAS: Control de cobros\n• REPORTES: Analytics y exportacion',
  
  'como usar filtros': 'Los filtros te ayudan a encontrar informacion:\n• Cada tabla tiene opciones de filtrado\n• Puedes filtrar por fechas, estados, categorias\n• Combina multiples filtros para busquedas precisas\n• Usa "Limpiar filtros" para resetear la vista\n• Los filtros se mantienen mientras navegas',
  
  // Respuesta por defecto
  'default': 'No entendi tu pregunta. Prueba preguntar sobre:\n• "Como agregar empleado"\n• "Como crear proyecto" \n• "Como generar reportes"\n• "Que modulos hay"\n• "Como solicitar vacaciones"\n• "Como crear factura"\n• "Como usar filtros"\n\nO escribe "ayuda general" para mas informacion.'
};
&nbsp;
// Palabras clave para detectar el tema de la pregunta
const KEYWORDS = <span class="cstat-no" title="statement not covered" >{</span>
  'empleado': ['empleado', 'personal', 'trabajador', 'staff'],
  'nomina': ['nomina', 'planilla', 'salario', 'pago', 'sueldo'],
  'vacaciones': ['vacaciones', 'descanso', 'tiempo libre', 'solicitud'],
  'inventario': ['inventario', 'stock', 'producto', 'existencia'],
  'proyecto': ['proyecto', 'cliente', 'trabajo'],
  'cotizacion': ['cotizacion', 'presupuesto', 'quote'],
  'factura': ['factura', 'cobro', 'pago', 'invoice'],
  'reporte': ['reporte', 'informe', 'exportar', 'pdf'],
  'navegacion': ['navegar', 'menu', 'donde', 'como llegar', 'dashboard'],
  'buscar': ['buscar', 'encontrar', 'filtrar', 'filtro'],
  'exportar': ['exportar', 'descargar', 'excel', 'pdf'],
  'login': ['login', 'iniciar', 'sesion', 'contraseña', 'acceso'],
  'modulos': ['modulos', 'secciones', 'que hay', 'disponible'],
  'general': ['ayuda', 'help', 'sistema', 'arce', 'vargas', 'que es']
};
&nbsp;
function <span class="fstat-no" title="function not covered" >findBestMatch(q</span>uestion: string): string {
  const lowerQuestion = <span class="cstat-no" title="statement not covered" >question.toLowerCase().trim();</span>
  
  // Buscar coincidencia exacta primero
<span class="cstat-no" title="statement not covered" >  for (const [key, response] of Object.entries(KNOWLEDGE_BASE)) {</span>
<span class="cstat-no" title="statement not covered" >    if (key !== 'default' &amp;&amp; lowerQuestion.includes(key)) {</span>
<span class="cstat-no" title="statement not covered" >      return response;</span>
    }
  }
  
  // Buscar por palabras clave
  let maxMatches = <span class="cstat-no" title="statement not covered" >0;</span>
  let bestCategory = <span class="cstat-no" title="statement not covered" >'';</span>
  
<span class="cstat-no" title="statement not covered" >  for (const [category, keywords] of Object.entries(KEYWORDS)) {</span>
    const matches = <span class="cstat-no" title="statement not covered" >keywords.filter(<span class="fstat-no" title="function not covered" >keyword =&gt; <span class="cstat-no" title="statement not covered" >l</span>owerQuestion.includes(keyword)).l</span>ength;</span>
<span class="cstat-no" title="statement not covered" >    if (matches &gt; maxMatches) {</span>
<span class="cstat-no" title="statement not covered" >      maxMatches = matches;</span>
<span class="cstat-no" title="statement not covered" >      bestCategory = category;</span>
    }
  }
  
  // Respuestas especificas por categoria
  const categoryResponses = <span class="cstat-no" title="statement not covered" >{</span>
    'empleado': KNOWLEDGE_BASE['como agregar empleado'],
    'nomina': KNOWLEDGE_BASE['que es nomina'],
    'vacaciones': KNOWLEDGE_BASE['como solicitar vacaciones'],
    'inventario': KNOWLEDGE_BASE['como agregar producto inventario'],
    'proyecto': KNOWLEDGE_BASE['como crear proyecto'],
    'cotizacion': KNOWLEDGE_BASE['como crear cotizacion'],
    'factura': KNOWLEDGE_BASE['como crear factura'],
    'reporte': KNOWLEDGE_BASE['como generar reportes'],
    'navegacion': KNOWLEDGE_BASE['como navegar sistema'],
    'buscar': KNOWLEDGE_BASE['como buscar'],
    'exportar': KNOWLEDGE_BASE['como exportar datos'],
    'login': KNOWLEDGE_BASE['problema login'],
    'modulos': KNOWLEDGE_BASE['que modulos hay'],
    'general': KNOWLEDGE_BASE['ayuda general']
  };
  
<span class="cstat-no" title="statement not covered" >  return Object.prototype.hasOwnProperty.call(categoryResponses, bestCategory) </span>
    ? categoryResponses[bestCategory as keyof typeof categoryResponses] 
    : KNOWLEDGE_BASE['default'];
}
&nbsp;
export async function <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >POST(r</span></span>equest: NextRequest) {
<span class="cstat-no" title="statement not covered" >  try {</span>
    const { question } = <span class="cstat-no" title="statement not covered" >await request.json();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!question) {</span>
<span class="cstat-no" title="statement not covered" >      return NextResponse.json(</span>
        { error: 'La pregunta es requerida' },
        { status: 400 }
      );
    }
&nbsp;
    // Usar el sistema de respuestas predefinidas
    const response = <span class="cstat-no" title="statement not covered" >findBestMatch(question);</span>
    
<span class="cstat-no" title="statement not covered" >    return NextResponse.json({ </span>
      response: response,
      type: 'predefined',
      timestamp: new Date().toISOString()
    });
&nbsp;
  } catch (error) {
<span class="cstat-no" title="statement not covered" >    console.error('Error en API de chat:', error);</span>
    
<span class="cstat-no" title="statement not covered" >    return NextResponse.json(</span>
      { error: 'Error interno del servidor' },
      { status: 500 }
    );
  }
}</pre></td></tr></table></pre>

                <div class='push'></div><!-- for sticky footer -->
            </div><!-- /wrapper -->
            <div class='footer quiet pad2 space-top1 center small'>
                Code coverage generated by
                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
                at 2025-08-09T18:40:59.739Z
            </div>
        <script src="../../../prettify.js"></script>
        <script>
            window.onload = function () {
                prettyPrint();
            };
        </script>
        <script src="../../../sorter.js"></script>
        <script src="../../../block-navigation.js"></script>
    </body>
</html>
    